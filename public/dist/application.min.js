"use strict";var ApplicationConfiguration=function(){var applicationModuleName="visit-ericeira",applicationModuleVendorDependencies=["ngResource","ngCookies","ngAnimate","ngTouch","ngSanitize","ui.router","ui.bootstrap","ui.utils","uiGmapgoogle-maps","easypiechart","duScroll","akoenig.deckgrid"],registerModule=function(moduleName,dependencies){angular.module(moduleName,dependencies||[]),angular.module(applicationModuleName).requires.push(moduleName)};return{applicationModuleName:applicationModuleName,applicationModuleVendorDependencies:applicationModuleVendorDependencies,registerModule:registerModule}}();angular.module(ApplicationConfiguration.applicationModuleName,ApplicationConfiguration.applicationModuleVendorDependencies),angular.module(ApplicationConfiguration.applicationModuleName).config(["$locationProvider",function($locationProvider){$locationProvider.hashPrefix("!")}]),angular.element(document).ready(function(){"#_=_"===window.location.hash&&(window.location.hash="#!"),angular.bootstrap(document,[ApplicationConfiguration.applicationModuleName])}),ApplicationConfiguration.registerModule("core",["easypiechart"]),ApplicationConfiguration.registerModule("users"),angular.module("core").config(["$stateProvider","$urlRouterProvider",function($stateProvider,$urlRouterProvider){$urlRouterProvider.otherwise("/"),$stateProvider.state("home",{url:"/",templateUrl:"modules/core/views/home.client.view.html"})}]),angular.module("core").controller("HeaderController",["$scope","Authentication","Menus",function($scope,Authentication,Menus){$scope.authentication=Authentication,$scope.isCollapsed=!1,$scope.menu=Menus.getMenu("topbar"),$scope.toggleCollapsibleMenu=function(){$scope.isCollapsed=!$scope.isCollapsed},$scope.$on("$stateChangeSuccess",function(){$scope.isCollapsed=!1})}]);var core=angular.module("core");core.config(["uiGmapGoogleMapApiProvider",function(uiGmapGoogleMapApiProvider){uiGmapGoogleMapApiProvider.configure({v:"3.17",libraries:"weather,geometry,visualization"})}]),core.controller("HomeController",["$scope","Authentication","$timeout","uiGmapGoogleMapApi",function($scope,Authentication,$timeout,uiGmapGoogleMapApi){$scope.authentication=Authentication,$scope.percent=65,$scope.options={size:140,rotate:0,lineWidth:10,animate:1e3,barColor:"#55738F",trackColor:"transparent",scaleColor:!1,lineCap:"butt"};var servicesDir="/modules/core/img/services/";$scope.services=[{percent:90,img:servicesDir+"service1.png",imgOpen:servicesDir+"service1open.jpg",href:"#surf_lessons",title:"Surf",description:"7 Waves in the 2nd World Surf Reserve"},{percent:80,img:servicesDir+"service2.png",imgOpen:servicesDir+"service2open.jpg",href:"#spots",title:"Beach",description:"11 Beaches within 5km"},{percent:65,img:servicesDir+"service3.png",imgOpen:servicesDir+"service3open.jpg",href:"#food",title:"Food",description:"Fresh Fish and Seafruits"}];var menuImgDir="/modules/core/img/menu/";$scope.menu=[{href:"#food",color:"red",img:menuImgDir+"drink.png",text:'Drink <span class="and">&</span> Eat'},{href:"#surf_lessons",color:"blue",img:menuImgDir+"surfist.png",text:"Fun"},{href:"#housing",color:"yellow",img:menuImgDir+"sleep.png",text:"Sleep"},{href:"#guide",color:"green",img:menuImgDir+"map.png",text:"Getting here"}];var dishesDir="/modules/core/img/dishes/",dishesDirSponsors="/modules/core/img/dishes/sponsors/";$scope.dishes=[{img:dishesDir+"bacalhau_bras.jpg",sponsor:dishesDirSponsors+"avatar.jpg",href:"#",name:"Bacalhau à Brás",description:"É um facto estabelecido de que um leitor é distraído pelo conteúdo legível de uma página quando analisa a sua mancha gráfica. Logo, o uso de Lorem Ipsum leva a uma distribuição "},{img:dishesDir+"pastel.jpg",sponsor:dishesDirSponsors+"avatar.jpg",href:"#",name:"Bacalhau à Brás",description:"É um facto estabelecido de que um leitor é distraído pelo conteúdo legível de uma página quando analisa a sua mancha gráfica. Logo, o uso de Lorem Ipsum leva a uma distribuição "},{img:dishesDir+"sardinhas.jpg",sponsor:dishesDirSponsors+"avatar.jpg",href:"#",name:"Bacalhau à Brás",description:"É um facto estabelecido de que um leitor é distraído pelo conteúdo legível de uma página quando analisa a sua mancha gráfica. Logo, o uso de Lorem Ipsum leva a uma distribuição "},{img:dishesDir+"sopa_rica.jpg",sponsor:dishesDirSponsors+"avatar.jpg",href:"#",name:"Bacalhau à Brás",description:"É um facto estabelecido de que um leitor é distraído pelo conteúdo legível de uma página quando analisa a sua mancha gráfica. Logo, o uso de Lorem Ipsum leva a uma distribuição "},{img:dishesDir+"bacalhau_bras.jpg",sponsor:dishesDirSponsors+"avatar.jpg",href:"#",name:"Bacalhau à Brás",description:"É um facto estabelecido de que um leitor é distraído pelo conteúdo legível de uma página quando analisa a sua mancha gráfica. Logo, o uso de Lorem Ipsum leva a uma distribuição "}],$scope.sponsors=[{img:"sponsor.jpg"},{img:"sponsor.jpg"},{img:"sponsor.jpg"},{img:"sponsor.jpg"}],$scope.lessons=[{color:"yellow",href:"#",img:"lesson.jpg",price:"50€/h",title:"Wave Surf School",descriptionTitle:"Begginer",durationTop:"15",durationUnit:"DAYS",description:"Surf lessons during one week. 2h per lesson. Surf suit and board included",icons:[{title:"car",href:"#",img:"car.png"}]},{color:"yellow",href:"#",img:"lesson.jpg",price:"50€/h",title:"Wave Surf School",descriptionTitle:"Begginer",durationTop:"15",durationUnit:"DAYS",description:"Surf lessons during one week. 2h per lesson. Surf suit and board included",icons:[{title:"car",href:"#",img:"car.png"}]},{color:"yellow",href:"#",img:"lesson.jpg",price:"50€/h",title:"Wave Surf School",descriptionTitle:"Begginer",durationTop:"15",durationUnit:"DAYS",description:"Surf lessons during one week. 2h per lesson. Surf suit and board included",icons:[{title:"car",href:"#",img:"car.png"}]}],uiGmapGoogleMapApi.then(function(){$scope.map={center:{latitude:38.99,longitude:-9.4223438},zoom:13,options:{mapTypeId:google.maps.MapTypeId.SATELLITE,scrollwheel:!1,draggable:!1}},$scope.randomMarkers=[];var markers=[],newMarker=function($latitude,$longitude,$title,$id){var marker={latitude:$latitude,longitude:$longitude,title:$title,id:$id,show:!1};return marker.onClick=function(){marker.show=!1,$scope.spotName=marker.title,$scope.wave=$scope.waves[marker.id]},marker};markers.push(newMarker("38.963215","-9.417070","Ericeira","ericeira")),markers.push(newMarker("38.987578","-9.419057","Ribeira D'ilhas","ribeira")),markers.push(newMarker("38.996169","-9.426985","Cave","cave")),markers.push(newMarker("38.979571","-9.423903","Pedra Branca","pedra")),markers.push(newMarker("38.983208","-9.422832","Reef","reef")),markers.push(newMarker("38.997583","-9.426225","Crazy Left","crazy")),markers.push(newMarker("39.000492","-9.427227","Coxos","coxos")),markers.push(newMarker("39.014289","-9.4243127","São Lourenço","s.lourenco")),$scope.randomMarkers=markers});var reef={name:"Reef",img:"tour1.png",description:"Continuing along Empa Beach, which is bordered by a small cliff, 300 metres to the north we find Pedra Branca’s twin beach and a wave called Reef. This right is formed from a very flat reef shelf which starts on land and gets deeper as it stretches NW. This is another regular, dangerous wave that has a very short, fast take-off zone followed by a barrel that ends exactly on the exposed shelf on the surface on the inside. It only works with N to NW swells at mid tide",type:{Type:"Rapid, powerful barrel right","Type of seabed":"Reef","Tide conditions":"Mid tide","Sweel conditions":"NW/N","Wind conditions":"SE to NE",Consistency:"++","Break angle":"35º","Length of break line":"30 to 70 meters","Wave height":"0.5 to 1.5 meters","Type of break":"Plunging",Level:"6"}},ribeira={name:"Ribeira D'Ilhas",img:"tour1.png",description:"If we walk 500 metres north, we come across the most memorable and cosmopolitan of all the waves in the reserve. Located in a valley with a sandy beach in the centre where a stream flows into the sea, it is shaped like a natural amphitheatre, which is perfect for surfing events. It is no surprise that it was the venue for the first national and international championships in Portugal. Ribeira d`Ilhas is a long pointbreak right, meaning that the waves follow the contour of the shore, which receives all types of swells and works in all kinds of tide. It is the most consistent wave in the region. Ribeira d’Ilhas and its W/NW swells can provide rights up to 200 metres long. It is a very valuable, competitive wave as it allows surfers very different levels of approach.",type:{Type:"Long right","Type of seabed":"Rocks and reef","Tide conditions":"All tides","Sweel conditions":"All (best on W/NW)","Wind conditions":"Any quadrand (best from SE to NE)",Consistency:"+ + + + +","Break angle":"55º","Length of break line":"150 to 300 meters","Wave height":"0.5 to 3.5 meters","Type of break":"Progressive/Plunging",Level:"4"}};$scope.waves={reef:reef,ribeira:ribeira},$scope.filters=["ALL","Surf","Ericeira","Nearby"],$scope.gallery=[{img:"img1.jpg",title:"Surf 1",filter:"Surf"},{img:"img2.jpg",title:"Surf 1",filter:"Surf"},{img:"img3.jpg",title:"Ericeira 1",filter:"Ericeira"},{img:"img4.jpg",title:"Ericeira 2",filter:"Ericeira"},{img:"img5.jpg",title:"Nearby 1",filter:"Nearby"},{img:"img6.jpg",title:"Nearby 2",filter:"Nearby"}]}]);var core=angular.module("core");core.directive("bannerSponsors",function(){return{restrict:"E",replace:!0,templateUrl:"/modules/core/views/sponsors.view.html",scope:{sponsors:"="}}});var core=angular.module("core");core.directive("hasOwlCarousel",function(){return{restrict:"A",link:function($scope,$element){$scope.$watch("dishes",function(){$scope.owl=$($element).children(".owl-carousel").owlCarousel({lazyLoad:!0,loop:!1,margin:15,nav:!1,responsiveClass:!0,responsive:{0:{items:1},600:{items:3},1e3:{items:4}}}),$scope.next=function(){$scope.owl.trigger("next.owl.carousel")},$scope.prev=function(){$scope.owl.trigger("prev.owl.carousel")}})}}});var core=angular.module("core");core.filter("galleryFilter",function(){return function(items,filter){return"ALL"==filter?items:items.filter(function(item){return item.filter===filter})}}),core.directive("gallery",function(){return{restrict:"AE",replace:!0,templateUrl:"/modules/core/views/gallery.view.html",scope:{filters:"=",album:"="},controller:["$scope","$filter",function($scope){$scope.selectedFilter=$scope.filters[0],$scope.selectFilter=function($selectedFilter){$scope.selectedFilter=$selectedFilter}}],link:function($scope,element){$(element).children(".fancybox-thumb").fancybox({prevEffect:"none",nextEffect:"none",helpers:{title:{type:"outside"},thumbs:{width:50,height:50}}})}}});var core=angular.module("core");core.directive("slider",["$interval","$window",function($interval,$window){return{restrict:"AE",replace:!0,templateUrl:"/modules/core/views/slider.view.html",scope:{slides:"=",speed:"@",dir:"@"},controller:["$scope",function($scope){$scope.slideIndex=0,$scope.images=[],$scope.images.push({src:$scope.dir+$scope.slides[$scope.slideIndex]}),$interval(function(){$scope.images=[],$scope.slideIndex=($scope.slideIndex+1)%$scope.slides.length,$scope.images.push({src:$scope.dir+$scope.slides[$scope.slideIndex]})},$scope.speed)}],link:function($scope,element){var resize=function(windowWidth){if(0==$(element).children().length)return 0;var naturalWidth=$(element).attr("width"),naturalHeight=$(element).attr("height"),newHeight=Math.round(windowWidth*(naturalHeight/naturalWidth));$(element).height(newHeight)};resize(),$scope.$watch(function(){return $window.innerWidth},resize)}}}]),angular.module("core").service("Menus",[function(){this.defaultRoles=["*"],this.menus={};var shouldRender=function(user){if(!user)return this.isPublic;if(~this.roles.indexOf("*"))return!0;for(var userRoleIndex in user.roles)for(var roleIndex in this.roles)if(this.roles[roleIndex]===user.roles[userRoleIndex])return!0;return!1};this.validateMenuExistance=function(menuId){if(menuId&&menuId.length){if(this.menus[menuId])return!0;throw new Error("Menu does not exists")}throw new Error("MenuId was not provided")},this.getMenu=function(menuId){return this.validateMenuExistance(menuId),this.menus[menuId]},this.addMenu=function(menuId,isPublic,roles){return this.menus[menuId]={isPublic:isPublic||!1,roles:roles||this.defaultRoles,items:[],shouldRender:shouldRender},this.menus[menuId]},this.removeMenu=function(menuId){this.validateMenuExistance(menuId),delete this.menus[menuId]},this.addMenuItem=function(menuId,menuItemTitle,menuItemURL,menuItemType,menuItemUIRoute,isPublic,roles,position){return this.validateMenuExistance(menuId),this.menus[menuId].items.push({title:menuItemTitle,link:menuItemURL,menuItemType:menuItemType||"item",menuItemClass:menuItemType,uiRoute:menuItemUIRoute||"/"+menuItemURL,isPublic:null===isPublic||"undefined"==typeof isPublic?this.menus[menuId].isPublic:isPublic,roles:null===roles||"undefined"==typeof roles?this.menus[menuId].roles:roles,position:position||0,items:[],shouldRender:shouldRender}),this.menus[menuId]},this.addSubMenuItem=function(menuId,rootMenuItemURL,menuItemTitle,menuItemURL,menuItemUIRoute,isPublic,roles,position){this.validateMenuExistance(menuId);for(var itemIndex in this.menus[menuId].items)this.menus[menuId].items[itemIndex].link===rootMenuItemURL&&this.menus[menuId].items[itemIndex].items.push({title:menuItemTitle,link:menuItemURL,uiRoute:menuItemUIRoute||"/"+menuItemURL,isPublic:null===isPublic||"undefined"==typeof isPublic?this.menus[menuId].items[itemIndex].isPublic:isPublic,roles:null===roles||"undefined"==typeof roles?this.menus[menuId].items[itemIndex].roles:roles,position:position||0,shouldRender:shouldRender});return this.menus[menuId]},this.removeMenuItem=function(menuId,menuItemURL){this.validateMenuExistance(menuId);for(var itemIndex in this.menus[menuId].items)this.menus[menuId].items[itemIndex].link===menuItemURL&&this.menus[menuId].items.splice(itemIndex,1);return this.menus[menuId]},this.removeSubMenuItem=function(menuId,submenuItemURL){this.validateMenuExistance(menuId);for(var itemIndex in this.menus[menuId].items)for(var subitemIndex in this.menus[menuId].items[itemIndex].items)this.menus[menuId].items[itemIndex].items[subitemIndex].link===submenuItemURL&&this.menus[menuId].items[itemIndex].items.splice(subitemIndex,1);return this.menus[menuId]},this.addMenu("topbar")}]),angular.module("users").config(["$httpProvider",function($httpProvider){$httpProvider.interceptors.push(["$q","$location","Authentication",function($q,$location,Authentication){return{responseError:function(rejection){switch(rejection.status){case 401:Authentication.user=null,$location.path("signin");break;case 403:}return $q.reject(rejection)}}}])}]),angular.module("users").config(["$stateProvider",function($stateProvider){$stateProvider.state("profile",{url:"/settings/profile",templateUrl:"modules/users/views/settings/edit-profile.client.view.html"}).state("password",{url:"/settings/password",templateUrl:"modules/users/views/settings/change-password.client.view.html"}).state("accounts",{url:"/settings/accounts",templateUrl:"modules/users/views/settings/social-accounts.client.view.html"}).state("signup",{url:"/signup",templateUrl:"modules/users/views/authentication/signup.client.view.html"}).state("signin",{url:"/signin",templateUrl:"modules/users/views/authentication/signin.client.view.html"}).state("forgot",{url:"/password/forgot",templateUrl:"modules/users/views/password/forgot-password.client.view.html"}).state("reset-invalid",{url:"/password/reset/invalid",templateUrl:"modules/users/views/password/reset-password-invalid.client.view.html"}).state("reset-success",{url:"/password/reset/success",templateUrl:"modules/users/views/password/reset-password-success.client.view.html"}).state("reset",{url:"/password/reset/:token",templateUrl:"modules/users/views/password/reset-password.client.view.html"})}]),angular.module("users").controller("AuthenticationController",["$scope","$http","$location","Authentication",function($scope,$http,$location,Authentication){$scope.authentication=Authentication,$scope.authentication.user&&$location.path("/"),$scope.signup=function(){$http.post("/auth/signup",$scope.credentials).success(function(response){$scope.authentication.user=response,$location.path("/")}).error(function(response){$scope.error=response.message})},$scope.signin=function(){$http.post("/auth/signin",$scope.credentials).success(function(response){$scope.authentication.user=response,$location.path("/")}).error(function(response){$scope.error=response.message})}}]),angular.module("users").controller("PasswordController",["$scope","$stateParams","$http","$location","Authentication",function($scope,$stateParams,$http,$location,Authentication){$scope.authentication=Authentication,$scope.authentication.user&&$location.path("/"),$scope.askForPasswordReset=function(){$scope.success=$scope.error=null,$http.post("/auth/forgot",$scope.credentials).success(function(response){$scope.credentials=null,$scope.success=response.message}).error(function(response){$scope.credentials=null,$scope.error=response.message})},$scope.resetUserPassword=function(){$scope.success=$scope.error=null,$http.post("/auth/reset/"+$stateParams.token,$scope.passwordDetails).success(function(response){$scope.passwordDetails=null,Authentication.user=response,$location.path("/password/reset/success")}).error(function(response){$scope.error=response.message})}}]),angular.module("users").controller("SettingsController",["$scope","$http","$location","Users","Authentication",function($scope,$http,$location,Users,Authentication){$scope.user=Authentication.user,$scope.user||$location.path("/"),$scope.hasConnectedAdditionalSocialAccounts=function(){for(var i in $scope.user.additionalProvidersData)return!0;return!1},$scope.isConnectedSocialAccount=function(provider){return $scope.user.provider===provider||$scope.user.additionalProvidersData&&$scope.user.additionalProvidersData[provider]},$scope.removeUserSocialAccount=function(provider){$scope.success=$scope.error=null,$http["delete"]("/users/accounts",{params:{provider:provider}}).success(function(response){$scope.success=!0,$scope.user=Authentication.user=response}).error(function(response){$scope.error=response.message})},$scope.updateUserProfile=function(isValid){if(isValid){$scope.success=$scope.error=null;var user=new Users($scope.user);user.$update(function(response){$scope.success=!0,Authentication.user=response},function(response){$scope.error=response.data.message})}else $scope.submitted=!0},$scope.changeUserPassword=function(){$scope.success=$scope.error=null,$http.post("/users/password",$scope.passwordDetails).success(function(){$scope.success=!0,$scope.passwordDetails=null}).error(function(response){$scope.error=response.message})}}]),angular.module("users").factory("Authentication",[function(){var _this=this;return _this._data={user:window.user},_this._data}]),angular.module("users").factory("Users",["$resource",function($resource){return $resource("users",{},{update:{method:"PUT"}})}]);